import{r as k}from"./regions-CqN045JU.js";import{_ as C,c as v,w as e,r as a,o as c,a as t,e as d,F as S,f as g,d as x,t as p,m as G,b as _}from"./index-DfQuzE6e.js";const R={data(){return{headers:[{title:"Дата",key:"timestamp"},{title:"Субъект РФ",key:"region"},{title:"Час",key:"hour"},{title:"ГЭС",key:"plan_GES"},{title:"АЭС",key:"plan_AES"},{title:"ТЭС",key:"plan_TES"},{title:"СЭС",key:"plan_SES"},{title:"ВЭС",key:"plan_VES"},{title:"Прочие ВИЭ",key:"plan_other"},{title:"ГЭС (мин тех)",key:"techmin_GES"},{title:"АЭС (мин тех)",key:"techmin_AES"},{title:"ТЭС (мин тех)",key:"techmin_TES"},{title:"СЭС (мин тех)",key:"techmin_SES"},{title:"ВЭС (мин тех)",key:"techmin_VES"},{title:"Прочие ВИЭ (мин тех)",key:"techmin_other"},{title:"ГЭС (мин техн)",key:"technomin_GES"},{title:"АЭС (мин техн)",key:"technomin_AES"},{title:"ТЭС (мин техн)",key:"technomin_TES"},{title:"СЭС (мин техн)",key:"technomin_SES"},{title:"ВЭС (мин техн)",key:"technomin_VES"},{title:"Прочие ВИЭ (мин техн)",key:"technomin_other"},{title:"ГЭС (макс тех)",key:"techmax_GES"},{title:"АЭС (макс тех)",key:"techmax_AES"},{title:"ТЭС (макс тех)",key:"techmax_TES"},{title:"СЭС (макс тех)",key:"techmax_SES"},{title:"ВЭС (макс тех)",key:"techmax_VES"},{title:"Прочие ВИЭ (макс тех)",key:"techmax_other"},{title:"План потребления",key:"plan_consumption"},{title:"План экспорта",key:"plan_export"},{title:"План импорта",key:"plan_import"},{title:"Цена покупки",key:"price_buy"},{title:"Цена продажи",key:"price_sell"},{title:"Полный план",key:"full_plan"}],boats:void 0,regions:k,filters:{},selectedRegion:void 0,selectedDateBefore:void 0,selectedDateAfter:void 0,loading:!1}},methods:{formatDateTime(s){return s.slice(0,19).replace("T"," ")}},computed:{virtualBoats(){return this.boats?[...Array(1e4).keys()].map(s=>{const l={...this.boats[s%this.boats.length]};return l.timestamp=this.formatDateTime(l.timestamp),l}):[]},filteredItems(){return this.virtualBoats.filter(s=>Object.entries(this.filters).every(([l,o])=>{if(!o)return!0;const m=s[l];return m!=null&&String(m).toLowerCase().includes(o.toLowerCase())}))}},async created(){this.selectedRegion=k[0].value;let s=new Date().toISOString().slice(0,16).replace("T"," "),l=new Date(Date.now()+864e5).toISOString().slice(0,16).replace("T"," ");this.selectedDateBefore=s,this.selectedDateAfter=l;try{this.loading=!0;const o=await fetch(`https://cloud-a.istu.edu/api/table?from=${this.selectedDateBefore}&to=${this.selectedDateAfter}`);this.boats=await o.json()}catch(o){this.errorMessage=o}finally{this.loading=!1}this.headers.forEach(o=>{this.filters[o.key]=""})}},U={class:"flex flex-col items-start"},I={class:"text-center pa-4"},L={key:0},N={key:1};function O(s,l,o,m,i,b){const u=a("v-text-field"),h=a("v-col"),E=a("v-btn"),D=a("v-list-item-title"),V=a("v-list-item"),w=a("v-list"),B=a("v-menu"),f=a("v-row"),T=a("v-data-table-virtual"),A=a("v-container");return c(),v(A,null,{default:e(()=>[t(f,null,{default:e(()=>[t(h,{cols:"12",md:"4"},{default:e(()=>[t(u,{modelValue:i.selectedDateBefore,"onUpdate:modelValue":l[0]||(l[0]=n=>i.selectedDateBefore=n),label:"Отображать с:",type:"datetime-local","hide-details":""},null,8,["modelValue"])]),_:1}),t(h,{cols:"12",md:"4"},{default:e(()=>[t(u,{modelValue:i.selectedDateAfter,"onUpdate:modelValue":l[1]||(l[1]=n=>i.selectedDateAfter=n),label:"Отображать до:",type:"datetime-local","hide-details":""},null,8,["modelValue"])]),_:1}),t(h,{cols:"12",md:"4"},{default:e(()=>[t(B,{location:"bottom"},{activator:e(({props:n})=>[t(E,G({color:"blue-grey-lighten-5"},n,{"min-height":"55px",block:""}),{default:e(()=>[x(p(i.selectedRegion),1)]),_:1},16)]),default:e(()=>[t(w,{style:{"max-height":"300px"}},{default:e(()=>[(c(!0),d(S,null,g(i.regions,(n,r)=>(c(),v(V,{key:r,value:r,onClick:y=>i.selectedRegion=n.value},{default:e(()=>[t(D,null,{default:e(()=>[x(p(n.value),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(f,null,{default:e(()=>[t(T,{headers:i.headers,items:b.virtualBoats,height:"1055","item-value":"date","fixed-header":"",style:{border:"1px solid rgba(0, 0, 0, 0.2)"}},{headers:e(({columns:n})=>[_("tr",null,[(c(!0),d(S,null,g(n,r=>(c(),d("th",{key:r.key,class:"px-2"},[_("div",U,[_("span",null,p(r.title),1),t(u,{modelValue:i.filters[r.key],"onUpdate:modelValue":y=>i.filters[r.key]=y,density:"compact",variant:"underlined","hide-details":"",class:"mt-1 w-32"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),"no-data":e(()=>[_("div",I,[i.loading?(c(),d("span",L,"Загрузка данных...")):(c(),d("span",N,"Данные отсутствуют"))])]),_:1},8,["headers","items"])]),_:1})]),_:1})}const M=C(R,[["render",O]]);export{M as default};
